# 🔧 解决 "Failed to download remote update" 错误

## 问题说明

这个错误表示 Expo Go 无法从开发服务器下载代码更新，通常是网络连接问题。

## ✅ 解决方案（按优先级）

### 方案 1：使用隧道模式（推荐，最稳定）⭐

隧道模式通过 Expo 的服务器中转，不依赖局域网，最稳定可靠。

#### 步骤：

1. **停止所有旧的服务器进程**：
   ```powershell
   # 双击运行
   快速修复连接.bat
   ```

2. **或者手动执行**：
   ```bash
   cd F:\A\mobile-app
   npm run start:tunnel
   ```

3. **首次使用需要登录**（如果还没登录）：
   ```bash
   npx expo login
   ```
   - 如果没有账号，访问 https://expo.dev 注册（免费）
   - 然后运行登录命令

4. **扫描新的二维码**：
   - 隧道模式会生成新的二维码
   - 用 Expo Go 扫描即可

#### 为什么隧道模式更好？

- ✅ **不依赖局域网**：手机和电脑可以不在同一 WiFi
- ✅ **更稳定**：通过 Expo 服务器中转，连接更可靠
- ✅ **配置简单**：不需要配置防火墙
- ✅ **可以在任何网络环境下使用**

---

### 方案 2：检查并修复网络（如果隧道模式不行）

#### 2.1 确保手机和电脑在同一 WiFi

#### 2.2 检查防火墙设置

以管理员身份运行 PowerShell：

```powershell
# 允许 Expo 开发服务器端口
New-NetFirewallRule -DisplayName "Expo Dev Server" -Direction Inbound -LocalPort 8081,8083 -Protocol TCP -Action Allow
```

#### 2.3 手动输入 URL

1. 在 Expo Go 中点击 "Enter URL manually"
2. 输入终端显示的地址（例如：`exp://192.168.1.100:8083`）

---

### 方案 3：清除缓存后重启

```bash
cd F:\A\mobile-app
npm run start:clear
```

这会清除 Metro bundler 缓存，然后重新启动。

---

### 方案 4：使用 USB 调试（Android）

```bash
cd F:\A\mobile-app
npm run android
```

**需要：**
- USB 连接手机
- 启用 USB 调试
- Android Studio 环境配置

---

### 方案 5：构建 APK（最可靠，但需要等待）

```bash
# 登录 EAS
eas login

# 配置构建
eas build:configure

# 构建 APK
npm run build:apk
```

---

## 🎯 推荐流程

1. **先尝试隧道模式**（最简单，双击 `快速修复连接.bat`）
2. **如果不行，检查网络配置**
3. **清除缓存后重试**
4. **最后考虑构建 APK**

---

## 📱 当前状态

如果看到终端显示：

```
› Metro waiting on exp://xxx.xxx.xxx.xxx:8083
```

说明服务器已启动，等待连接。

**下一步：**
1. 打开 Expo Go 应用
2. 扫描终端显示的二维码
3. 或手动输入 URL

---

## ❓ 常见问题

### Q: 隧道模式需要登录，但我没有账号？

A: 访问 https://expo.dev 注册，完全免费。

### Q: 隧道模式很慢？

A: 隧道模式通过 Expo 服务器中转，可能比局域网慢一些，但更稳定。如果局域网连接正常，可以使用 LAN 模式。

### Q: 还是连接不上？

A: 
1. 检查手机网络是否正常
2. 尝试重启 Expo Go 应用
3. 检查是否有 VPN 或代理影响连接
4. 尝试清除 Expo Go 应用缓存

---

## 🚀 快速操作

**最简单的方法**：双击运行 `快速修复连接.bat`

这会自动：
- 停止旧的服务器进程
- 启动隧道模式
- 显示二维码

然后直接用 Expo Go 扫描即可！

